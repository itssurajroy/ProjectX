
{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user's public and private profile data.",
      "properties": {
        "displayName": {
          "type": "string",
          "description": "The user's public display name."
        },
        "photoURL": {
          "type": "string",
          "format": "uri",
          "description": "URL to the user's profile picture."
        },
        "role": {
          "type": "string",
          "description": "User role for permissions.",
          "enum": ["user"],
          "default": "user"
        },
        "createdAt": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp when the user account was created."
        }
      },
      "required": ["displayName", "role", "createdAt"]
    },
    "UserHistory": {
      "title": "UserHistory",
      "type": "object",
      "description": "Represents a user's watch history for a single episode.",
      "properties": {
        "animeId": { "type": "string" },
        "episodeId": { "type": "string" },
        "episodeNumber": { "type": "number" },
        "watchedAt": { "type": "string", "format": "date-time" },
        "progress": { "type": "number", "description": "Time in seconds" },
        "duration": { "type": "number", "description": "Total duration in seconds" }
      },
      "required": ["animeId", "episodeId", "episodeNumber", "watchedAt", "progress", "duration"]
    },
    "WatchlistItem": {
      "title": "WatchlistItem",
      "type": "object",
      "description": "An item in a user's watchlist.",
      "properties": {
        "animeId": { "type": "string" },
        "name": { "type": "string" },
        "poster": { "type": "string", "format": "uri" },
        "status": { "type": "string", "enum": ["Watching", "Completed", "On-Hold", "Dropped", "Plan to Watch"] },
        "addedAt": { "type": "string", "format": "date-time" },
        "notes": { "type": "string" }
      },
      "required": ["animeId", "name", "poster", "status", "addedAt"]
    },
    "WatchTogetherRoom": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "WatchTogetherRoom",
      "type": "object",
      "description": "Represents a Watch Together room where users can watch content together.",
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the Watch Together room."
        },
        "animeId": {
          "type": "string",
          "description": "ID of the anime being watched."
        },
        "episodeId": {
          "type": "string",
          "description": "ID of the episode being watched."
        },
        "episodeNumber": {
          "type": "number",
          "description": "Episode number being watched."
        },
        "hostId": {
          "type": "string",
          "description": "User ID of the room host."
        },
        "createdAt": {
          "type": "string",
          "description": "Date and time the room was created.",
          "format": "date-time"
        },
        "playerState": {
          "type": "object",
          "description": "The current state of the video player.",
          "properties": {
            "isPlaying": {
              "type": "boolean"
            },
            "currentTime": {
              "type": "number"
            },
            "updatedAt": {
              "type": "string",
              "format": "date-time"
            }
          },
          "required": ["isPlaying", "currentTime", "updatedAt"]
        }
      },
      "required": [
        "name",
        "animeId",
        "episodeId",
        "episodeNumber",
        "hostId",
        "createdAt",
        "playerState"
      ]
    },
    "RoomUser": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "RoomUser",
      "type": "object",
      "description": "Represents a user within a Watch Together room.",
      "properties": {
        "id": {
          "type": "string",
          "description": "User's unique identifier."
        },
        "name": {
          "type": "string",
          "description": "Display name of the user."
        },
        "avatar": {
          "type": "string",
          "description": "URL of the user's avatar."
        },
        "isHost": {
          "type": "boolean",
          "description": "True if this user is the host."
        }
      },
      "required": ["id", "name", "avatar", "isHost"]
    },
    "ChatMessage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChatMessage",
      "type": "object",
      "description": "Represents a chat message within a Watch Together room.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "ID of the user who sent the message."
        },
        "userName": {
          "type": "string",
          "description": "Name of the user who sent the message."
        },
        "avatar": {
          "type": "string",
          "description": "Avatar of the user who sent the message."
        },
        "text": {
          "type": "string",
          "description": "Text content of the chat message."
        },
        "timestamp": {
          "type": "string",
          "description": "Timestamp of when the message was sent.",
          "format": "date-time"
        }
      },
      "required": ["userId", "userName", "text", "timestamp"]
    },
    "Comment": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Comment",
        "type": "object",
        "description": "Represents a user comment on an anime or episode.",
        "properties": {
          "animeId": { "type": "string" },
          "episodeId": { "type": "string" },
          "userId": { "type": "string" },
          "username": { "type": "string" },
          "text": { "type": "string" },
          "parentId": { "type": "string", "description": "ID of the parent comment for threading." },
          "spoiler": { "type": "boolean" },
          "likes": { "type": "array", "items": { "type": "string" }, "description": "Array of user IDs who liked the comment." },
          "timestamp": { "type": "string", "format": "date-time" },
          "userAvatar": { "type": "string", "format": "uri" },
          "rank": { "type": "string" }
        },
        "required": ["animeId", "userId", "username", "text", "spoiler", "likes", "timestamp"]
    },
     "Anime": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Anime",
      "type": "object",
      "description": "Represents an anime series or movie.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the anime."
        },
        "title": {
          "type": "string",
          "description": "Title of the anime."
        },
        "posterUrl": {
          "type": "string",
          "description": "URL of the anime's poster image.",
          "format": "uri"
        },
        "description": {
          "type": "string",
          "description": "Description of the anime."
        }
      },
      "required": [
        "id",
        "title",
        "posterUrl"
      ]
    }
  },
  "auth": {
    "providers": [
      "email",
      "anonymous",
      "google"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores public user profile information."
        }
      },
      {
        "path": "/users/{userId}/history/{animeId}",
        "definition": {
          "entityName": "UserHistory",
          "schema": {
            "$ref": "#/backend/entities/UserHistory"
          },
          "description": "Stores user watch history."
        }
      },
      {
        "path": "/users/{userId}/watchlist/{animeId}",
        "definition": {
            "entityName": "WatchlistItem",
            "schema": {
                "$ref": "#/backend/entities/WatchlistItem"
            },
            "description": "Stores a user's watchlist."
        }
      },
      {
        "path": "/watch2gether_rooms/{roomId}",
        "definition": {
          "entityName": "WatchTogetherRoom",
          "schema": {
            "$ref": "#/backend/entities/WatchTogetherRoom"
          },
          "description": "Stores active Watch Together rooms."
        }
      },
      {
        "path": "/watch2gether_rooms/{roomId}/users/{userId}",
        "definition": {
          "entityName": "RoomUser",
          "schema": {
            "$ref": "#/backend/entities/RoomUser"
          },
          "description": "Stores participants of a specific room."
        }
      },
      {
        "path": "/watch2gether_rooms/{roomId}/messages/{messageId}",
        "definition": {
          "entityName": "ChatMessage",
          "schema": {
            "$ref": "#/backend/entities/ChatMessage"
          },
          "description": "Stores chat messages for a specific room."
        }
      },
      {
        "path": "/comments/{animeId}/messages/{commentId}",
        "definition": {
            "entityName": "Comment",
            "schema": {
                "$ref": "#/backend/entities/Comment"
            },
            "description": "Stores comments for a specific anime or episode."
        }
      },
      {
        "path": "/anime/{animeId}",
        "definition": {
          "entityName": "Anime",
          "schema": {
            "$ref": "#/backend/entities/Anime"
          },
          "description": "Stores information about anime series and movies."
        }
      }
    ]
  }
}
