
{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user's public and private profile data.",
      "properties": {
        "displayName": {
          "type": "string",
          "description": "The user's public display name."
        },
        "photoURL": {
          "type": "string",
          "format": "uri",
          "description": "URL to the user's profile picture."
        },
        "role": {
          "type": "string",
          "description": "User role for permissions.",
          "enum": ["user", "moderator", "admin"],
          "default": "user"
        },
        "createdAt": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp when the user account was created."
        }
      },
      "required": ["displayName", "role", "createdAt"]
    },
    "UserHistory": {
      "title": "UserHistory",
      "type": "object",
      "description": "Represents a user's watch history for a single episode.",
      "properties": {
        "animeId": { "type": "string" },
        "episodeId": { "type": "string" },
        "episodeNumber": { "type": "number" },
        "watchedAt": { "type": "string", "format": "date-time" },
        "progress": { "type": "number", "description": "Time in seconds" },
        "duration": { "type": "number", "description": "Total duration in seconds" }
      },
      "required": ["animeId", "episodeId", "episodeNumber", "watchedAt", "progress", "duration"]
    },
    "WatchTogetherRoom": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "WatchTogetherRoom",
      "type": "object",
      "description": "Represents a Watch Together room where users can watch content together.",
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the Watch Together room."
        },
        "animeId": {
          "type": "string",
          "description": "ID of the anime being watched."
        },
        "episodeId": {
          "type": "string",
          "description": "ID of the episode being watched."
        },
        "episodeNumber": {
          "type": "number",
          "description": "Episode number being watched."
        },
        "hostId": {
          "type": "string",
          "description": "User ID of the room host."
        },
        "createdAt": {
          "type": "string",
          "description": "Date and time the room was created.",
          "format": "date-time"
        },
        "playerState": {
          "type": "object",
          "description": "The current state of the video player.",
          "properties": {
            "isPlaying": {
              "type": "boolean"
            },
            "currentTime": {
              "type": "number"
            },
            "updatedAt": {
              "type": "string",
              "format": "date-time"
            }
          },
          "required": ["isPlaying", "currentTime", "updatedAt"]
        }
      },
      "required": [
        "name",
        "animeId",
        "episodeId",
        "episodeNumber",
        "hostId",
        "createdAt",
        "playerState"
      ]
    },
    "RoomUser": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "RoomUser",
      "type": "object",
      "description": "Represents a user within a Watch Together room.",
      "properties": {
        "id": {
          "type": "string",
          "description": "User's unique identifier."
        },
        "name": {
          "type": "string",
          "description": "Display name of the user."
        },
        "avatar": {
          "type": "string",
          "description": "URL of the user's avatar."
        },
        "isHost": {
          "type": "boolean",
          "description": "True if this user is the host."
        }
      },
      "required": ["id", "name", "avatar", "isHost"]
    },
    "ChatMessage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChatMessage",
      "type": "object",
      "description": "Represents a chat message within a Watch Together room.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "ID of the user who sent the message."
        },
        "userName": {
          "type": "string",
          "description": "Name of the user who sent the message."
        },
        "avatar": {
          "type": "string",
          "description": "Avatar of the user who sent the message."
        },
        "text": {
          "type": "string",
          "description": "Text content of the chat message."
        },
        "timestamp": {
          "type": "string",
          "description": "Timestamp of when the message was sent.",
          "format": "date-time"
        }
      },
      "required": ["userId", "userName", "text", "timestamp"]
    },
     "Anime": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Anime",
      "type": "object",
      "description": "Represents an anime series or movie.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the anime."
        },
        "title": {
          "type": "string",
          "description": "Title of the anime."
        },
        "posterUrl": {
          "type": "string",
          "description": "URL of the anime's poster image.",
          "format": "uri"
        },
        "description": {
          "type": "string",
          "description": "Description of the anime."
        }
      },
      "required": [
        "id",
        "title",
        "posterUrl"
      ]
    },
    "ForumCategory": {
      "title": "ForumCategory",
      "type": "object",
      "description": "Represents a category in the forum.",
      "properties": {
        "name": { "type": "string" },
        "description": { "type": "string" },
        "slug": { "type": "string" },
        "threadCount": { "type": "number", "default": 0 },
        "postCount": { "type": "number", "default": 0 }
      },
      "required": ["name", "slug"]
    },
    "ForumThread": {
        "title": "ForumThread",
        "type": "object",
        "description": "Represents a single thread in the forum.",
        "properties": {
            "title": { "type": "string" },
            "content": { "type": "string" },
            "authorId": { "type": "string" },
            "categoryId": { "type": "string" },
            "createdAt": { "type": "string", "format": "date-time" },
            "updatedAt": { "type": "string", "format": "date-time" },
            "isLocked": { "type": "boolean", "default": false },
            "isPinned": { "type": "boolean", "default": false },
            "replyCount": { "type": "number", "default": 0 },
            "viewCount": { "type": "number", "default": 0 },
            "upvotes": { "type": "number", "default": 0 },
            "downvotes": { "type": "number", "default": 0 }
        },
        "required": ["title", "content", "authorId", "categoryId", "createdAt"]
    },
    "ForumReply": {
        "title": "ForumReply",
        "type": "object",
        "description": "Represents a reply within a forum thread.",
        "properties": {
            "threadId": { "type": "string" },
            "authorId": { "type": "string" },
            "content": { "type": "string" },
            "createdAt": { "type": "string", "format": "date-time" },
            "parentId": { "type": "string", "description": "ID of the parent reply, for nesting." },
            "upvotes": { "type": "number", "default": 0 },
            "downvotes": { "type": "number", "default": 0 }
        },
        "required": ["threadId", "authorId", "content", "createdAt"]
    },
    "UserForumProfile": {
      "title": "UserForumProfile",
      "type": "object",
      "description": "Stores a user's forum-related stats and gamification progress.",
      "properties": {
        "xp": { "type": "number", "default": 0 },
        "level": { "type": "number", "default": 1 },
        "rank": { "type": "string", "default": "Genin" },
        "badges": { "type": "array", "items": { "type": "string" } },
        "dailyStreak": { "type": "number", "default": 0 },
        "lastPostDate": { "type": "string", "format": "date-time" }
      }
    }
  },
  "auth": {
    "providers": [
      "email",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores public user profile information."
        }
      },
      {
        "path": "/users/{userId}/forumProfile/data",
        "definition": {
            "entityName": "UserForumProfile",
            "schema": { "$ref": "#/backend/entities/UserForumProfile" },
            "description": "Stores a user's forum-related stats and gamification progress."
        }
      },
      {
        "path": "/users/{userId}/history/{animeId}",
        "definition": {
          "entityName": "UserHistory",
          "schema": {
            "$ref": "#/backend/entities/UserHistory"
          },
          "description": "Stores user watch history."
        }
      },
      {
        "path": "/watch2gether_rooms/{roomId}",
        "definition": {
          "entityName": "WatchTogetherRoom",
          "schema": {
            "$ref": "#/backend/entities/WatchTogetherRoom"
          },
          "description": "Stores active Watch Together rooms."
        }
      },
      {
        "path": "/watch2gether_rooms/{roomId}/users/{userId}",
        "definition": {
          "entityName": "RoomUser",
          "schema": {
            "$ref": "#/backend/entities/RoomUser"
          },
          "description": "Stores participants of a specific room."
        }
      },
      {
        "path": "/watch2gether_rooms/{roomId}/messages/{messageId}",
        "definition": {
          "entityName": "ChatMessage",
          "schema": {
            "$ref": "#/backend/entities/ChatMessage"
          },
          "description": "Stores chat messages for a specific room."
        }
      },
      {
        "path": "/anime/{animeId}",
        "definition": {
          "entityName": "Anime",
          "schema": {
            "$ref": "#/backend/entities/Anime"
          },
          "description": "Stores information about anime series and movies."
        }
      },
      {
        "path": "/forum_categories/{categoryId}",
        "definition": {
            "entityName": "ForumCategory",
            "schema": { "$ref": "#/backend/entities/ForumCategory" },
            "description": "List of all forum categories."
        }
      },
      {
          "path": "/forum_threads/{threadId}",
          "definition": {
              "entityName": "ForumThread",
              "schema": { "$ref": "#/backend/entities/ForumThread" },
              "description": "Collection of all forum threads."
          }
      },
      {
          "path": "/forum_threads/{threadId}/replies/{replyId}",
          "definition": {
              "entityName": "ForumReply",
              "schema": { "$ref": "#/backend/entities/ForumReply" },
              "description": "Replies for a specific thread."
          }
      },
       {
        "path": "/forum_chat/{messageId}",
        "definition": {
          "entityName": "ChatMessage",
          "schema": {
            "$ref": "#/backend/entities/ChatMessage"
          },
          "description": "Stores messages for the global forum live chat."
        }
      }
    ]
  }
}
